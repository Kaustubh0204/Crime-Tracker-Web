<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home | LawPlus</title>
    <link rel="icon" href="assets/shield.png" type="image/icon type">
    <!--Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <!--Google Fonts-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@300;400;500;700;800&display=swap"
        rel="stylesheet">
    <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/996973c893.js" crossorigin="anonymous"></script>
    <!--Map Box-->
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet' />
    <!--Javascript (Modal Trigger)  -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

</head>

<body onload="GetPoliceStations()"
    style="background-color: #181820; font-family: 'Work Sans', sans-serif; max-width: 1900px;">
    <nav class="navbar navbar-expand-lg"
        style="background-color: #1D1D27; box-shadow: 0px 8px 8px -6px rgba(0,0,0,.25);">
        <div class="container-fluid">
            <img src="assets/shield.png" alt="" width="26" height="26" class="d-inline-block align-text-top">
            <a class="navbar-brand" style="color: #FC76A1; font-weight: 700;"> &nbspLawPlus</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <!-- <a class="nav-link active" aria-current="page" href="#">Home</a> -->
                    </li>
                </ul>
                <ul class="navbar-nav ml-auto">

                    <li class="nav-item" id="profilepicicon">
                        <!-- <img src="assets/profilepic.png" type="button" data-bs-toggle="modal"
                            data-bs-target="#exampleModal" style="margin: 0.2vw; height: 35px; width: 35px;"> -->
                    </li>

                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid" style="background-color: #181820; ">
        <div class="row">
            <div class="col-2" style=" background-color: #1D1D27; text-align: left; border-bottom-right-radius: 1vw;">
                <table class="container" style="margin-top: 3vw; ">
                    <tbody style="color: white;">
                        <tr class="fade-item">
                            <td class="fade-item"
                                style="padding: 1vw; border-radius: 0.5vw; background-color: #272732;"><i
                                    style="background-color: #FC76A1; padding: 8px; font-size: 20px; border-radius: 1vw;"
                                    class="fas fa-exclamation-circle"></i><span
                                    style="font-size: 15px; font-weight: 500;">
                                    &nbsp<a href="home.html"> Cases</a></span> </td>
                        </tr>
                        <tr style="height: 1vw;">
                        <tr>
                            <td class="fade-item" style="padding: 1vw; border-radius: 0.5vw;"><i
                                    style="background-color: #70C4BF; padding: 8px; font-size: 20px; border-radius: 1vw;"
                                    class="fas fa-chart-line"></i><span style="font-size: 15px; font-weight: 500;">
                                    &nbsp<a href="analytics.html"> Analytics</a></span> </td>
                        </tr>
                        <tr style="height: 1vw;"></tr>
                        <tr>
                            <td class="fade-item" style="padding: 1vw; border-radius: 0.5vw;"><i
                                    style="background-color: #AE68E6; padding: 8px; font-size: 20px; border-radius: 1vw;"
                                    class="fas fa-book"></i><span style="font-size: 15px; font-weight: 500;">
                                    &nbsp<a href="documentation.html"> Documentation</a></span> </td>
                        </tr>
                        <tr style="height: 1vw;"></tr>
                        <tr>
                            <td class="fade-item" style="padding: 1vw; border-radius: 0.5vw;"><i
                                    style="background-color: #E39264; padding: 8px; font-size: 20px; border-radius: 1vw;"
                                    class="fas fa-user-friends"></i><span style="font-size: 15px; font-weight: 500;">
                                    &nbsp<a href="aboutus.html"> About Us</a></span> </td>
                        </tr>
                    </tbody>
                </table>
            </div>


            <div class="col-10" style="background-color: #181820; text-align: center;">


                <div class="btn-group" role="group" aria-label="Basic example"
                    style="position: relative; z-index: 1; top: 11%; left: 34%;">
                    <button onclick="GetPoliceStations()" type="button" class="btn"
                        style="background-color: #FC76A1;"><img src="assets/badge.png"></button>
                    <button onclick="switchLayer('dark-v10')" type="button" class="btn btn-dark"><i class="fas fa-moon"
                            style="color: #FAB91D; font-size: 24px;"></i></button>
                    <button onclick="switchLayer('streets-v11')" type="button" class="btn"
                        style="background-color: #71c7ec;"><i class="fas fa-sun"
                            style="color: #FF781F; font-size: 24px;"></i></button>
                    <button onclick="switchLayer('satellite-v9')" type="button" class="btn"
                        style="background-color: #8ABAAE;"><i class="fas fa-globe-americas"
                            style="color: #0D6EFD; font-size: 24px;"></i></button>
                    <button onclick="switchLayer2()" type="button" class="btn" style="background-color: #348361;"><img
                            src="assets/radioactivity.png" style="height: 28px; width: 28px;"></button>

                </div>

                <div id="map" class="container" style="margin-top: 0px; width: 95%; height: 620px; border-radius: 2vw;">
                </div>

            </div>
        </div>

        <br>

        <div class="row"
            style="width: 100%; background-color: #1D1D27; margin-left: 0.07%; padding: 1vw; border-radius: 2vw; overflow: visible;">
            <h5 style="color: white;" class="mx-1 my-2">Recent Cases</h5>
            <div class="input-group mb-4 my-3 mx-1" style="width: 300px;">
                <input id="searchreport" type="text" class="form-control" placeholder="Search case ID"
                    style="color: white; background-color: #343446; border-color: #FC76A1;" aria-label="Search case ID"
                    aria-describedby="button-addon2">
                <button id="searchbutton" onclick="SearchReport()" class="btn btn-outline-secondary" type="button"
                    id="button-addon2" style="border-color: #FC76A1;"><i class="fas fa-search"></i></button>
            </div>

            <div class="row" id="userreports">

            </div>



        </div>

        <br>

        <!--solved case modal-->
        <div class="modal fade" id="solved-case-modal" tabindex="-1" aria-labelledby="exampleModalLabel"
            data-bs-backdrop="static" data-bs-keyboard="false" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content" style="background-color: #1D1D26; border-radius: 2vw;">
                    <div class="modal-header"
                        style="background-color: #1D1D26; border-color: #1D1D26; border-radius: 2vw;">
                        <h5 class="modal-title" id="exampleModalLabel" style="color: white">Close case</h5>
                        <button type="button" class="btn-close btn-close-white" onclick="resetmodalfooter()"></button>
                    </div>
                    <div class="modal-body">
                        <h5 style="color:#FC76A1">Enter report details</h5>
                        <hr style="background-color: #FC76A1;">
                        <textarea id="policeStatement" class="form-control" rows="10"
                            style="color: white; background-color: #1D1D26; border-color: #FC76A1;"></textarea>
                        <hr style="background-color: #FC76A1;">
                        <h5 style="color:#FC76A1">Enter high security password</h5>
                        <input id="highsecuritypassword" class="form-control" type="password"
                            style="color: white; background-color: #1D1D26; border-color: #FC76A1;"></input>
                    </div>
                    <br>
                    <div id="upperdivsolvedcasemodalfooter">

                        <!-- <button type="button" class="btn hover-item"  onclick="deleteReport2()"
                                style="color: white; background-color: #FC76A1; border-radius: 1vw;">Delete report</button> -->

                    </div>
                </div>
            </div>
        </div>

        <!--solved case modal failure-->
        <div class="modal fade" id="solved-case-modal-failure" tabindex="-1" aria-labelledby="exampleModalLabel">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content" style="background-color: #1D1D26; border-radius: 2vw;">
                    <div class="modal-header"
                        style="background-color: #1D1D26; border-color: #1D1D26; border-radius: 2vw; ">
                        <h5 class="modal-title" id="exampleModalLabel" style="color: white; font-weight: 700;">
                            Error</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" style="background-color: #1D1D26; text-align: center; color: #fc76a1">
                        <i style="font-size: 7vw;" class="fas fa-exclamation-triangle"></i>
                        <br><br>
                        <p id="solved-case-modal-error" style="color: #fc76a1"></p>
                    </div>
                    <div
                        style="background-color: #1D1D26; text-align: center; border-radius: 2vw; margin-bottom: 1.5vw;">
                        <br>
                        <!-- <button data-bs-dismiss="modal" type="button" data-bs-toggle="modal"
                            data-bs-target="#solved-case-modal" 
                            class="btn-lg hover-item"
                            style="background-color: #fc76a1; border-color: #fc76a1; font-weight: 500; color: white; border-radius: 1vw;">Try
                            Again</button> -->

                    </div>
                </div>
            </div>
        </div>

        <!--solved case modal success-->
        <div class="modal fade" id="solved-case-modal-success" tabindex="-1" aria-labelledby="exampleModalLabel"
            data-bs-backdrop="static" data-bs-keyboard="false" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content" style="background-color: #1D1D26; border-radius: 2vw;">
                    <div class="modal-header"
                        style="background-color: #1D1D26; border-color: #1D1D26; border-radius: 2vw; ">
                        <h5 class="modal-title" id="exampleModalLabel" style="color: white; font-weight: 700;">
                            Deletion Successful</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" style="background-color: #1D1D26; text-align: center; color: #fc76a1">
                        <i style="font-size: 7vw;" class="fas fa-trash-alt"></i>
                        <br><br>
                        <p style="color: #fc76a1">Report deleted.</p>
                    </div>
                    <div
                        style="background-color: #1D1D26; text-align: center; border-radius: 2vw; margin-bottom: 1.5vw;">
                        <br>
                        <button class="btn-lg hover-item" data-bs-dismiss="modal"
                            style="background-color: #30303D;  font-weight: 500; color: white; border-radius: 1vw;">
                            OK</button>
                    </div>
                </div>
            </div>
        </div>




        <!-- Profile Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content" style="background-color: #1D1D26; border-radius: 2vw;">
                    <div class="modal-header"
                        style="background-color: #1D1D26; border-color: #1D1D26; border-radius: 2vw; ">
                        <h5 class="modal-title" id="exampleModalLabel" style="color: white; font-weight: 700;">Your
                            Profile
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body" style="background-color: #1D1D26; text-align: center; ">

                        <div id="profilemodal">

                        </div>

                        <label for="file" class="btn" style="position: absolute; top: 41%; right: 33%;"><img
                                src="assets/uploadimage.png"></label>
                        <input type="file" id="file" style="background-color: #FC76A1;" class="inputfile">
                        <style>
                            .inputfile {
                                width: 0.1px;
                                height: 0.1px;
                                opacity: 0;
                                overflow: hidden;
                                position: absolute;
                                z-index: -1;
                            }
                        </style>

                        <p id="pleasewait" style="color: #FC76A1; font-size: 12px;"></p>

                        <div style="height: 20px;"></div>
                        <ul class="list-group list-group-flush">
                            <li style="background-color: #1D1D26; color: #FC76A1; font-size: 20px; font-weight: 600;"
                                class="list-group-item" id="profilename"></li>
                            <li style="background-color: #1D1D26; color: #FC76A1;" class="list-group-item"
                                id="profilepost">
                            </li>
                            <li style="background-color: #1D1D26; color: #FC76A1;" class="list-group-item"
                                id="profileemail">
                            </li>
                            <li style="background-color: #1D1D26; color: #FC76A1;" class="list-group-item"
                                id="profilephoneno">
                            </li>
                        </ul>

                    </div>
                    <div
                        style="background-color: #1D1D26; text-align: center; border-radius: 2vw; margin-bottom: 1.5vw;">
                        <a onclick="logout()" type="button" class="btn-lg hover-item"
                            style="background-color: #30303D; border-color: #fc76a1; font-weight: 500; color: white; border-radius: 1vw;"><i
                                class="fas fa-sign-out-alt"></i> Log Out</a>
                    </div>
                </div>
            </div>
        </div>



        <script>
            const file = document.getElementById("file")
            const img = document.getElementById("img")
            const url = document.getElementById("url")
            file.addEventListener("change", ev => {

                const pleasewait = document.querySelector("#pleasewait")
                pleasewait.innerHTML += '<br><br>Please wait for another 10 seconds<br>while we update your profile picture.'

                const formdata = new FormData()
                formdata.append("image", ev.target.files[0])
                fetch("https://api.imgur.com/3/image/", {
                    method: "post",
                    headers: {
                        Authorization: "Client-ID 580de07a0898c59"
                    },
                    body: formdata
                }).then(data => data.json()).then(data => {
                    // img.src = data.data.link
                    console.log(data.data.link);

                    firebase.auth().onAuthStateChanged(function (user) {

                        db.collection("police").where("email", "==", user.email)
                            .get()
                            .then((querySnapshot) => {
                                querySnapshot.forEach((doc) => {



                                    var currentdoc = doc.id;
                                    db.collection('police').doc(currentdoc).update({

                                        photo: data.data.link
                                    });

                                });
                            })

                    });

                    setTimeout(function () {
                        window.location.reload(1);
                    }, 5000);

                })
            })


        </script>


        <style>
            .hover-item {
                transition: 0.3s;
            }

            .hover-item:hover {
                transform: translate(0, -5px);
            }

            .fade-item:hover {
                background-color: #272732;
            }

            a {

                text-decoration: none;
                color: white;
            }

            a:hover {
                color: #FB4B83;
            }

            #searchbutton:hover {
                color: #FC76A1;
            }

            .marker {
                background-image: url('assets/danger.svg');
                border-style: solid;
                border-color: #FC76A1;
                background-color: #FC76A1;
                background-size: cover;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                cursor: pointer;
            }

            .mapboxgl-popup-content {
                font-family: 'Work Sans', sans-serif;
                border-style: solid;
                border-radius: 1vw;
                border-color: #FC76A1;
                color: #FC76A1;
                background-color: #1D1D26;
            }

            .mapboxgl-popup-close-button{
                color: #FC76A1;
            }

            .mapboxgl-popup-anchor-top .mapboxgl-popup-tip,
            .mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip,
            .mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip {
                border-bottom-color: #FC76A1;
            }

            .mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip,
            .mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip,
            .mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip {
                border-top-color: #FC76A1
            }

            .mapboxgl-popup-anchor-left .mapboxgl-popup-tip {
                border-right-color: #FC76A1
            }

            .mapboxgl-popup-anchor-right .mapboxgl-popup-tip {
                border-left-color: #FC76A1
            }
            .casehover{
                cursor: pointer;
            }
            .casehover:hover{
                color: #FB2367;
            }
        </style>

        <script>
            mapboxgl.accessToken = 'pk.eyJ1Ijoia2F1c3R1YmgwMjA0IiwiYSI6ImNrcjR5c20xMDA1ZDEyd215NGRrcDQxcWwifQ.omZ2nYvuSAL1IHqjrt3eHQ';
            var map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/dark-v10',
                center: [72.9977, 19.0760],
                zoom: 10,
                minZoom: 4 
            });

            function GetPoliceStations() {
                // map.on('load', function () {
                map.loadImage("https://i.imgur.com/AMhXOvd.png", function (error, image) { //this is where we load the image file 
                    if (error) throw error;
                    map.addImage("custom-marker", image); //this is where we name the image file we are loading 
                    map.addLayer({
                        'id': "markers", //this is the name of the layer, it is what we will reference below 
                        'type': "symbol",
                        'source': { //now we are adding the source to the layer more directly and cleanly 
                            type: "geojson",
                            data: 'police-station2.geojson' // CHANGE THIS TO REFLECT WHERE YOUR DATA IS COMING FROM
                            // 'https://energydata.info/dataset/e6c15a08-fd67-4a53-b03f-6b071557fbf4/resource/1f4d18e7-9747-4a9c-be70-7f4855ba62d4/download/hydro-power-projects.geojson'
                            // 'https://gis-geoserver.ehealthafrica.org/geoserver/eHA_db/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=eHA_db:sv_police_stations&outputFormat=application%2Fjson&authkey=fdfe9a37-d2d0-4210-9a15-25dab5d907fa'
                        },
                        'layout': {
                            "icon-image": "custom-marker", // the name of image file we used above
                            "icon-allow-overlap": false,
                            "icon-size": 1 //this is a multiplier applied to the standard size. So if you want it half the size put ".5"
                        }
                    })
                })



                // })

                map.on('click', function (e) {
                    var features = map.queryRenderedFeatures(e.point, {
                        layers: ['markers'] // replace this with the name of the layer
                    });

                    if (!features.length) {
                        return;
                    }

                    var feature = features[0];



                    if (feature.geometry.coordinates[0] < 50) {

                        var popup = new mapboxgl.Popup({ offset: [0, -15] })
                            .setLngLat(feature.geometry.coordinates)
                            .setHTML('<h5>' + feature.properties.name + '</h5><hr><h6>ID: ' + feature.properties.id + '</h6><h6>State code: ' + feature.properties.state_code + '</h6>') // CHANGE THIS TO REFLECT THE PROPERTIES YOU WANT TO SHOW
                            .setLngLat(feature.geometry.coordinates)
                            .addTo(map);

                    } else {
                        var popup = new mapboxgl.Popup({ offset: [0, -15] })
                            .setLngLat(feature.geometry.coordinates)
                            .setHTML('<h5>' + feature.properties.name + '</h5><hr style="background-color: #FC76A1; border: none; height: 1px;"><h6>Zone: ' + feature.properties.zone + '<br>' + 'Phone: ' + feature.properties.phone + '<br> City: ' + feature.properties.city + '</h6>') // CHANGE THIS TO REFLECT THE PROPERTIES YOU WANT TO SHOW
                            .setLngLat(feature.geometry.coordinates)
                            .addTo(map);
                    }


                });






            }

            function switchLayer(layer) {
                map.setStyle('mapbox://styles/mapbox/' + layer);
            }

            function switchLayer2() {
                map.setStyle('mapbox://styles/kaustubh0204/ckrxqgtpy9z4417p4kpg0cxbp');
            }


        </script>



        <script src="https://www.gstatic.com/firebasejs/8.7.1/firebase.js"></script>
        <script>
            // Initialize Firebase
            var config = {
                apiKey: "AIzaSyAOghuR0V463DQDrclJBRqMNH7YDqavNmY",
                authDomain: "crime-mapping-7610d.firebaseapp.com",
                projectId: "crime-mapping-7610d",
                storageBucket: "crime-mapping-7610d.appspot.com",
                messagingSenderId: "928787398601",
                appId: "1:928787398601:web:56f96b0e2a1b41aee47218",
                measurementId: "G-KW51ES0TGV"
            };
            firebase.initializeApp(config);
        </script>

        <script src="logout.js"></script>
        <script src="report.js"></script>
        <script src="index.js"></script>
        <script src="authenticate.js"></script>

</body>

</html>